<div class="flex flex-col h-fit w-full overflow-y-auto">
    <form class="max-feed-sm:mt-3 mb-3">
        <mat-card class="feed-sm:p-3 max-feed-sm:p-1">
            <div class="flex items-center gap-5 mb-4 relative">
                <app-avatar-photo [imageLink]="currentUser.profileImagePath"></app-avatar-photo>

                <mat-form-field class="w-full">
                    <mat-label>What's on your mind ?</mat-label>

                    <textarea matInput [cdkTextareaAutosize]="true"
                              [formControl]="contentControl"
                              #postContent maxlength="300"
                              placeholder="I am thinking about...">
                    </textarea>

                    <button mat-icon-button color="basic" matSuffix
                            (click)="isOpened = !isOpened"
                            aria-label="Add Feeling" type="button">
                        <mat-icon>mood</mat-icon>
                    </button>

                    <mat-hint align="end">{{ postContent.value.length }} / 300</mat-hint>
                </mat-form-field>

                @if (isOpened) {
                    <emoji-mart
                            class="picker"
                            color="#0df4e2"
                            set="twitter"
                            title="Pick your emojiâ€¦"
                            emoji="point_up"
                            [isNative]="true"
                            (emojiSelect)="emojiSelected($event)"
                            [darkMode]="true">
                    </emoji-mart>
                }
            </div>

            <mat-divider class="divider"></mat-divider>

            <div class="flex items-center justify-evenly">
                <button mat-button color="basic"
                        (click)="isAttachingImagesOpened = !isAttachingImagesOpened"
                        aria-label="Attach Image" type="button">
                    <mat-icon>image</mat-icon>
                    Image
                </button>

                <button mat-raised-button color="primary"
                        [disabled]="postContent.value.length === 0 && attachedImagesLength === 0"
                        aria-label="New Post" type="submit">
                    <mat-icon>send</mat-icon>
                    Post
                </button>
            </div>
        </mat-card>

        <app-drop-image [isAttachingImagesOpened]="isAttachingImagesOpened"
                        (attachedImagesLength)="attachedImagesLength = $event">
        </app-drop-image>
    </form>

    @for (post of posts; track post) {
        @if (isPost(post)) {
            <app-post [post]="post"></app-post>
        } @else {
            <app-shared-post [post]="post"></app-shared-post>
        }
    }
</div>
